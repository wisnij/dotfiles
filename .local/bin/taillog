#!/bin/bash
# Output new lines in file(s) as they're added, with timestamps

gray='\033[38;5;8m'
normal='\033[0m'

if type -p gtail >/dev/null; then
    tail=gtail
else
    tail=tail
fi

if [[ $# -gt 0 ]]; then
    # Follow provided file(s) by name
    args=(-F "$@")
else
    # No args, so read from stdin
    args=(-)
fi

$tail "${args[@]}" | while IFS= read -r line; do
    printf "$gray[%s]$normal %s\n" "$(date +'%F %T %Z')" "$line"
done
